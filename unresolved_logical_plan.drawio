<mxfile host="app.diagrams.net" modified="2022-04-04T11:15:41.694Z" agent="5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/99.0.4844.84 Safari/537.36" etag="TamlSZ8V5hW37iSpSrHn" version="17.4.0" type="github">
  <diagram id="_TAUJCwC3Z414NcdCWBq" name="Page-1">
    <mxGraphModel dx="2779" dy="1047" grid="0" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="827" pageHeight="1169" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="T3wzXR9VALe59u5OGyin-3" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontColor=default;fontFamily=Comic Sans MS;" parent="1" source="T3wzXR9VALe59u5OGyin-1" target="T3wzXR9VALe59u5OGyin-2" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="T3wzXR9VALe59u5OGyin-1" value="&lt;div&gt;&lt;font&gt;&lt;span style=&quot;font-size: 13.0667px&quot;&gt;plan = parsePlan(&quot;SELECT A,B FROM TESTA&quot;)&lt;/span&gt;&lt;span style=&quot;font-size: 9.8pt&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;sketch=1;fillColor=none;shadow=0;glass=0;labelBackgroundColor=none;fontFamily=Comic Sans MS;" parent="1" vertex="1">
          <mxGeometry x="-606.84" y="63" width="328" height="50" as="geometry" />
        </mxCell>
        <mxCell id="T3wzXR9VALe59u5OGyin-6" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontFamily=Comic Sans MS;fontSize=11;fontColor=#A680B8;" parent="1" source="T3wzXR9VALe59u5OGyin-2" target="T3wzXR9VALe59u5OGyin-5" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="T3wzXR9VALe59u5OGyin-2" value="&lt;div&gt;&lt;font&gt;&lt;span style=&quot;font-size: 13.0667px&quot;&gt;ParseDriver.parse()&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;sketch=1;fillColor=none;shadow=0;glass=0;labelBackgroundColor=none;fontFamily=Comic Sans MS;" parent="1" vertex="1">
          <mxGeometry x="-522.34" y="142" width="159" height="50" as="geometry" />
        </mxCell>
        <mxCell id="T3wzXR9VALe59u5OGyin-4" value="词法语法解析" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;shadow=0;glass=0;labelBackgroundColor=none;sketch=1;fontSize=11;fontColor=#6666FF;fontFamily=Comic Sans MS;" parent="1" vertex="1">
          <mxGeometry x="-603.84" y="152" width="74" height="30" as="geometry" />
        </mxCell>
        <mxCell id="T3wzXR9VALe59u5OGyin-30" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontFamily=Comic Sans MS;fontSize=11;fontColor=#6666FF;" parent="1" source="T3wzXR9VALe59u5OGyin-5" target="T3wzXR9VALe59u5OGyin-14" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="T3wzXR9VALe59u5OGyin-5" value="&lt;div&gt;&lt;font&gt;&lt;span style=&quot;font-size: 13.0667px&quot;&gt;&amp;nbsp;ParseDriver.parsePlan(){&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font&gt;&lt;span style=&quot;font-size: 13.0667px&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp;parser.singleStatement()&lt;/span&gt;&lt;span style=&quot;font-size: 13.0667px&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font&gt;&lt;span style=&quot;font-size: 13.0667px&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp;astBuilder.visitSingleStatement()&lt;/span&gt;&lt;span style=&quot;font-size: 13.0667px&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font&gt;&lt;span style=&quot;font-size: 13.0667px&quot;&gt;&amp;nbsp;}&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;sketch=0;fillColor=#dae8fc;strokeColor=#6c8ebf;shadow=0;glass=0;labelBackgroundColor=none;fontFamily=Comic Sans MS;align=left;" parent="1" vertex="1">
          <mxGeometry x="-563.6500000000001" y="218" width="241.62" height="82" as="geometry" />
        </mxCell>
        <mxCell id="T3wzXR9VALe59u5OGyin-32" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontFamily=Comic Sans MS;fontSize=10;fontColor=#6666FF;" parent="1" source="T3wzXR9VALe59u5OGyin-14" target="T3wzXR9VALe59u5OGyin-18" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="T3wzXR9VALe59u5OGyin-14" value="&lt;div&gt;&lt;div&gt;&lt;span style=&quot;font-size: 13.0667px&quot;&gt;AstBuilder.visitSingleStatement(){&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;font-size: 13.0667px&quot;&gt;visit(ctx.statement)&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;font-size: 13.0667px&quot;&gt;}&lt;/span&gt;&lt;/div&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;sketch=1;fillColor=none;shadow=0;glass=0;labelBackgroundColor=none;fontFamily=Comic Sans MS;align=center;" parent="1" vertex="1">
          <mxGeometry x="-557.09" y="327" width="227.5" height="68" as="geometry" />
        </mxCell>
        <mxCell id="T3wzXR9VALe59u5OGyin-36" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontFamily=Comic Sans MS;fontSize=10;fontColor=#6666FF;" parent="1" source="T3wzXR9VALe59u5OGyin-18" target="T3wzXR9VALe59u5OGyin-35" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="T3wzXR9VALe59u5OGyin-18" value="&lt;div&gt;&lt;span style=&quot;font-size: 13.0667px&quot;&gt;AbstractParseTreeVisitor.visit(ParseTree tree){&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;font-size: 13.0667px&quot;&gt;tree.accept(this)&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;font-size: 13.0667px&quot;&gt;}&lt;/span&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;sketch=1;fillColor=none;shadow=0;glass=0;labelBackgroundColor=none;fontFamily=Comic Sans MS;" parent="1" vertex="1">
          <mxGeometry x="-275.24" y="329" width="305" height="64" as="geometry" />
        </mxCell>
        <mxCell id="T3wzXR9VALe59u5OGyin-31" value="&lt;h1 style=&quot;font-size: 10px&quot;&gt;生成未解析的逻辑执行计划&lt;/h1&gt;&lt;div style=&quot;font-size: 10px&quot;&gt;1. 生成AstTree&lt;/div&gt;&lt;div style=&quot;font-size: 10px&quot;&gt;2. astBuilder对象去访问Tree&lt;/div&gt;" style="text;html=1;strokeColor=none;fillColor=none;spacing=5;spacingTop=-20;whiteSpace=wrap;overflow=hidden;rounded=0;shadow=0;glass=0;labelBackgroundColor=none;sketch=1;fontFamily=Comic Sans MS;fontSize=10;fontColor=#6666FF;" parent="1" vertex="1">
          <mxGeometry x="-734.1700000000001" y="237" width="187" height="66" as="geometry" />
        </mxCell>
        <mxCell id="T3wzXR9VALe59u5OGyin-34" value="AstBuilder的visit方法继承自AbstractParseTreeVisitor的visit" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;shadow=0;glass=0;labelBackgroundColor=none;sketch=1;fontSize=11;fontColor=#6666FF;fontFamily=Comic Sans MS;" parent="1" vertex="1">
          <mxGeometry x="-213.84000000000003" y="277" width="192" height="57" as="geometry" />
        </mxCell>
        <mxCell id="T3wzXR9VALe59u5OGyin-39" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontFamily=Comic Sans MS;fontSize=10;fontColor=#6666FF;" parent="1" source="T3wzXR9VALe59u5OGyin-35" target="T3wzXR9VALe59u5OGyin-38" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="T3wzXR9VALe59u5OGyin-35" value="&lt;div&gt;&lt;span style=&quot;font-size: 13.0667px&quot;&gt;SqlBaseParser.StatementDefaultContext{&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;font-size: 13.0667px&quot;&gt;accept(visitor){&lt;/span&gt;&lt;/div&gt;&lt;span style=&quot;font-size: 13.0667px&quot;&gt;visitor.visitStatementDefault(this)&lt;/span&gt;&lt;div&gt;&lt;span style=&quot;font-size: 13.0667px&quot;&gt;}}&lt;/span&gt;&lt;br&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;sketch=1;fillColor=#d5e8d4;shadow=0;glass=0;labelBackgroundColor=none;fontFamily=Comic Sans MS;strokeColor=#82b366;" parent="1" vertex="1">
          <mxGeometry x="-284.49" y="422" width="323.5" height="71" as="geometry" />
        </mxCell>
        <mxCell id="T3wzXR9VALe59u5OGyin-37" value="会调用当前参数的accept方法&lt;br&gt;如当前为StatementDefaultContext" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;shadow=0;glass=0;labelBackgroundColor=none;sketch=1;fontSize=11;fontColor=#6666FF;fontFamily=Comic Sans MS;" parent="1" vertex="1">
          <mxGeometry x="44.15999999999997" y="426" width="213" height="53" as="geometry" />
        </mxCell>
        <mxCell id="T3wzXR9VALe59u5OGyin-42" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontFamily=Comic Sans MS;fontSize=10;fontColor=#6666FF;exitX=0.499;exitY=0.981;exitDx=0;exitDy=0;exitPerimeter=0;" parent="1" source="T3wzXR9VALe59u5OGyin-38" target="T3wzXR9VALe59u5OGyin-41" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="-122.72888888888917" y="596" as="sourcePoint" />
            <Array as="points">
              <mxPoint x="-122.84000000000003" y="603" />
              <mxPoint x="-438.84000000000003" y="603" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="T3wzXR9VALe59u5OGyin-38" value="&lt;div&gt;&lt;div&gt;&lt;span style=&quot;font-size: 13.0667px&quot;&gt;SqlBaseBaseVisitor.visitStatementDefault(ctx){&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;font-size: 13.0667px&quot;&gt;&amp;nbsp; &amp;nbsp; this.visitChildren(ctx)&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;font-size: 13.0667px&quot;&gt;}&lt;/span&gt;&lt;/div&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;sketch=1;fillColor=#d5e8d4;shadow=0;glass=0;labelBackgroundColor=none;fontFamily=Comic Sans MS;strokeColor=#82b366;" parent="1" vertex="1">
          <mxGeometry x="-284.49" y="515" width="323.5" height="71" as="geometry" />
        </mxCell>
        <mxCell id="T3wzXR9VALe59u5OGyin-40" value="若当前节点非重要节点，spark不会重写方法，而是直接调用&lt;br&gt;&lt;div class=&quot;okr-block-clipboard&quot;&gt;&lt;/div&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;shadow=0;glass=0;labelBackgroundColor=none;sketch=1;fontSize=11;fontColor=#6666FF;fontFamily=Comic Sans MS;" parent="1" vertex="1">
          <mxGeometry x="47.15999999999997" y="523" width="199" height="63" as="geometry" />
        </mxCell>
        <mxCell id="T3wzXR9VALe59u5OGyin-46" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontFamily=Comic Sans MS;fontSize=10;fontColor=#6666FF;" parent="1" source="T3wzXR9VALe59u5OGyin-41" target="T3wzXR9VALe59u5OGyin-45" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="T3wzXR9VALe59u5OGyin-41" value="&lt;div&gt;&lt;span style=&quot;font-size: 13.0667px&quot;&gt;AstBuilder.visitChildren(){&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;font-size: 13.0667px&quot;&gt;&amp;nbsp; node.getChild(0).accept(this)&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;font-size: 13.0667px&quot;&gt;}&lt;/span&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;sketch=1;fillColor=#dae8fc;shadow=0;glass=0;labelBackgroundColor=none;fontFamily=Comic Sans MS;strokeColor=#6c8ebf;" parent="1" vertex="1">
          <mxGeometry x="-535.25" y="623" width="191.75" height="62" as="geometry" />
        </mxCell>
        <mxCell id="T3wzXR9VALe59u5OGyin-44" value="进行重写，调用孩子节点accept()方法实现从&amp;nbsp;&lt;br&gt;&lt;span&gt;&lt;font color=&quot;#ff3333&quot;&gt;StatementDefaultContext -&amp;gt; QueryContext&lt;/font&gt;&lt;br&gt;&lt;/span&gt;&lt;div class=&quot;okr-block-clipboard&quot;&gt;&lt;/div&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;shadow=0;glass=0;labelBackgroundColor=none;sketch=1;fontSize=11;fontColor=#6666FF;fontFamily=Comic Sans MS;" parent="1" vertex="1">
          <mxGeometry x="-798" y="618.5" width="262.75" height="71" as="geometry" />
        </mxCell>
        <mxCell id="T3wzXR9VALe59u5OGyin-48" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontFamily=Comic Sans MS;fontSize=10;fontColor=#6666FF;exitX=0.5;exitY=1;exitDx=0;exitDy=0;" parent="1" source="T3wzXR9VALe59u5OGyin-45" target="T3wzXR9VALe59u5OGyin-47" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="T3wzXR9VALe59u5OGyin-45" value="&lt;div&gt;SqlBaseBaseParser.QueryContext {&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; accept(visitor){&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; visitor.visitQuery(this)&lt;/div&gt;&lt;div&gt;}}&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;sketch=1;fillColor=none;shadow=0;glass=0;labelBackgroundColor=none;fontFamily=Comic Sans MS;" parent="1" vertex="1">
          <mxGeometry x="-237.21000000000004" y="621" width="232.25" height="66" as="geometry" />
        </mxCell>
        <mxCell id="bS2-JoX9ewdRHK1aLQZ--2" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="T3wzXR9VALe59u5OGyin-47" target="bS2-JoX9ewdRHK1aLQZ--1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="T3wzXR9VALe59u5OGyin-47" value="&lt;div&gt;AstBuilder.visitQuery {&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; query = plan(ctx.queryTerm)&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; // Apply CTEs ...&lt;/div&gt;&lt;div&gt;}&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;sketch=0;fillColor=#f8cecc;shadow=0;glass=0;labelBackgroundColor=none;fontFamily=Comic Sans MS;strokeColor=#b85450;" parent="1" vertex="1">
          <mxGeometry x="-535.25" y="729.5" width="183.81" height="58" as="geometry" />
        </mxCell>
        <mxCell id="T3wzXR9VALe59u5OGyin-49" value="query下有两个节点，spark进行重写&lt;br&gt;此处会处理CTEs&lt;div class=&quot;okr-block-clipboard&quot;&gt;&lt;/div&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;shadow=0;glass=0;labelBackgroundColor=none;sketch=1;fontSize=11;fontColor=#FF3333;fontFamily=Comic Sans MS;" parent="1" vertex="1">
          <mxGeometry x="-742.25" y="727" width="203.16" height="56.5" as="geometry" />
        </mxCell>
        <mxCell id="T3wzXR9VALe59u5OGyin-50" value="调用子节点的accept方法，子节点为QueryContext" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;shadow=0;glass=0;labelBackgroundColor=none;sketch=1;fontSize=11;fontColor=#6666FF;fontFamily=Comic Sans MS;" parent="1" vertex="1">
          <mxGeometry x="1.1599999999999682" y="627.5" width="213" height="53" as="geometry" />
        </mxCell>
        <mxCell id="bS2-JoX9ewdRHK1aLQZ--5" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="bS2-JoX9ewdRHK1aLQZ--1" target="bS2-JoX9ewdRHK1aLQZ--4">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="bS2-JoX9ewdRHK1aLQZ--1" value="SqlBaseParser.QueryContext{&lt;br&gt;queryTerm(){&lt;br&gt;this.getRuleContext&lt;br&gt;}}" style="rounded=1;whiteSpace=wrap;html=1;sketch=1;fillColor=none;shadow=0;glass=0;labelBackgroundColor=none;fontFamily=Comic Sans MS;" vertex="1" parent="1">
          <mxGeometry x="-223.93" y="725.75" width="196" height="65.5" as="geometry" />
        </mxCell>
        <mxCell id="bS2-JoX9ewdRHK1aLQZ--3" value="QueryContext里先调用queryTerm方法，queryTerm里执行的是getRuleContext" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;shadow=0;glass=0;labelBackgroundColor=none;sketch=1;fontSize=11;fontColor=#6666FF;fontFamily=Comic Sans MS;" vertex="1" parent="1">
          <mxGeometry x="-18.840000000000032" y="729.5" width="213" height="53" as="geometry" />
        </mxCell>
        <mxCell id="bS2-JoX9ewdRHK1aLQZ--8" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="bS2-JoX9ewdRHK1aLQZ--4" target="bS2-JoX9ewdRHK1aLQZ--7">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="-125.84000000000003" y="879" />
              <mxPoint x="-429.84000000000003" y="879" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="bS2-JoX9ewdRHK1aLQZ--4" value="ParserRuleContext.getRuleContext(ctx){&lt;br&gt;getChild()&lt;br&gt;}" style="rounded=1;whiteSpace=wrap;html=1;sketch=1;fillColor=none;shadow=0;glass=0;labelBackgroundColor=none;fontFamily=Comic Sans MS;" vertex="1" parent="1">
          <mxGeometry x="-248.93000000000006" y="809.5" width="246" height="56" as="geometry" />
        </mxCell>
        <mxCell id="bS2-JoX9ewdRHK1aLQZ--6" value="实际上执行getChild，此时从&lt;br&gt;&lt;font color=&quot;#ff3333&quot;&gt;QueryContext -&amp;gt; QueryTermDefaultContext&lt;/font&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;shadow=0;glass=0;labelBackgroundColor=none;sketch=1;fontSize=11;fontColor=#6666FF;fontFamily=Comic Sans MS;" vertex="1" parent="1">
          <mxGeometry x="1.1599999999999682" y="803" width="259" height="69" as="geometry" />
        </mxCell>
        <mxCell id="bS2-JoX9ewdRHK1aLQZ--11" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="bS2-JoX9ewdRHK1aLQZ--7" target="bS2-JoX9ewdRHK1aLQZ--10">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="bS2-JoX9ewdRHK1aLQZ--7" value="AstBuilder.plan(tree) = typedVisit(tree)" style="rounded=1;whiteSpace=wrap;html=1;sketch=1;fillColor=none;shadow=0;glass=0;labelBackgroundColor=none;fontFamily=Comic Sans MS;" vertex="1" parent="1">
          <mxGeometry x="-547.1700000000001" y="899" width="237" height="44" as="geometry" />
        </mxCell>
        <mxCell id="bS2-JoX9ewdRHK1aLQZ--9" value="ctx.queryTerm生成后，执行plan方法，plan里实际调用是typedVisit()" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;shadow=0;glass=0;labelBackgroundColor=none;sketch=1;fontSize=11;fontColor=#6666FF;fontFamily=Comic Sans MS;" vertex="1" parent="1">
          <mxGeometry x="-742.25" y="899" width="189.9" height="50" as="geometry" />
        </mxCell>
        <mxCell id="bS2-JoX9ewdRHK1aLQZ--14" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontColor=#FF0000;" edge="1" parent="1" source="bS2-JoX9ewdRHK1aLQZ--10" target="bS2-JoX9ewdRHK1aLQZ--13">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="bS2-JoX9ewdRHK1aLQZ--10" value="AstBuilder.typedVisit(ctx){&lt;br&gt;ctx.accept(this)&lt;br&gt;}" style="rounded=1;whiteSpace=wrap;html=1;sketch=1;fillColor=none;shadow=0;glass=0;labelBackgroundColor=none;fontFamily=Comic Sans MS;" vertex="1" parent="1">
          <mxGeometry x="-547.1700000000001" y="977" width="238.33" height="48" as="geometry" />
        </mxCell>
        <mxCell id="bS2-JoX9ewdRHK1aLQZ--12" value="typedVisit里实际执行的也是当前对象的accept方法" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;shadow=0;glass=0;labelBackgroundColor=none;sketch=1;fontSize=11;fontColor=#6666FF;fontFamily=Comic Sans MS;" vertex="1" parent="1">
          <mxGeometry x="-746.99" y="975" width="189.9" height="50" as="geometry" />
        </mxCell>
        <mxCell id="bS2-JoX9ewdRHK1aLQZ--16" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontColor=#FF0000;" edge="1" parent="1" source="bS2-JoX9ewdRHK1aLQZ--13" target="bS2-JoX9ewdRHK1aLQZ--15">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="bS2-JoX9ewdRHK1aLQZ--13" value="&lt;div&gt;SqlBaseParser.QueryTermDefaultContext{&lt;/div&gt;&lt;div&gt;accept(visitor){&lt;/div&gt;&lt;div&gt;visitor.visitQueryTermDefault(this)&lt;/div&gt;&lt;div&gt;}}&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;sketch=1;fillColor=#d5e8d4;shadow=0;glass=0;labelBackgroundColor=none;fontFamily=Comic Sans MS;strokeColor=#82b366;" vertex="1" parent="1">
          <mxGeometry x="-259.84000000000003" y="968" width="284" height="66" as="geometry" />
        </mxCell>
        <mxCell id="bS2-JoX9ewdRHK1aLQZ--20" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontColor=#6666FF;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="bS2-JoX9ewdRHK1aLQZ--15" target="bS2-JoX9ewdRHK1aLQZ--19">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="-118.84000000000003" y="1133" />
              <mxPoint x="-442.84000000000003" y="1133" />
              <mxPoint x="-442.84000000000003" y="1151" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="bS2-JoX9ewdRHK1aLQZ--15" value="&lt;div&gt;SqlBaseBaseVisitor.visitQueryTermDefault(ctx){&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; this.visitChildren(ctx)&lt;/div&gt;&lt;div&gt;}&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;sketch=1;fillColor=#d5e8d4;shadow=0;glass=0;labelBackgroundColor=none;fontFamily=Comic Sans MS;strokeColor=#82b366;" vertex="1" parent="1">
          <mxGeometry x="-258.84000000000003" y="1057" width="282" height="57" as="geometry" />
        </mxCell>
        <mxCell id="bS2-JoX9ewdRHK1aLQZ--17" value="当前对象为QueryTermDefaultContext，调用对象的accept方法" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;shadow=0;glass=0;labelBackgroundColor=none;sketch=1;fontSize=11;fontColor=#6666FF;fontFamily=Comic Sans MS;" vertex="1" parent="1">
          <mxGeometry x="35.15999999999997" y="972" width="231" height="53" as="geometry" />
        </mxCell>
        <mxCell id="bS2-JoX9ewdRHK1aLQZ--18" value="未重写，直接调用&lt;br&gt;&lt;div class=&quot;okr-block-clipboard&quot;&gt;&lt;/div&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;shadow=0;glass=0;labelBackgroundColor=none;sketch=1;fontSize=11;fontColor=#6666FF;fontFamily=Comic Sans MS;" vertex="1" parent="1">
          <mxGeometry x="21.909999999999968" y="1068" width="131.5" height="41" as="geometry" />
        </mxCell>
        <mxCell id="bS2-JoX9ewdRHK1aLQZ--22" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontColor=#6666FF;" edge="1" parent="1" source="bS2-JoX9ewdRHK1aLQZ--19" target="bS2-JoX9ewdRHK1aLQZ--21">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="bS2-JoX9ewdRHK1aLQZ--19" value="&lt;div&gt;&lt;span style=&quot;font-size: 13.0667px&quot;&gt;AstBuilder.visitChildren(){&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;font-size: 13.0667px&quot;&gt;&amp;nbsp; node.getChild(0).accept(this)&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;font-size: 13.0667px&quot;&gt;}&lt;/span&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;sketch=1;fillColor=#dae8fc;shadow=0;glass=0;labelBackgroundColor=none;fontFamily=Comic Sans MS;strokeColor=#6c8ebf;" vertex="1" parent="1">
          <mxGeometry x="-539.09" y="1151" width="191.81" height="62" as="geometry" />
        </mxCell>
        <mxCell id="bS2-JoX9ewdRHK1aLQZ--25" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontColor=#6666FF;" edge="1" parent="1" source="bS2-JoX9ewdRHK1aLQZ--21" target="bS2-JoX9ewdRHK1aLQZ--24">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="bS2-JoX9ewdRHK1aLQZ--21" value="&lt;span style=&quot;font-size: 13.0667px&quot;&gt;SqlBaseParser.QueryPrimaryDefaultContext{&lt;/span&gt;&lt;br&gt;&lt;span style=&quot;font-size: 13.0667px&quot;&gt;accept(visitor){&lt;br&gt;visitQueryPrimaryDefault(this)&lt;br&gt;}}&lt;/span&gt;" style="rounded=1;whiteSpace=wrap;html=1;sketch=1;fillColor=#d5e8d4;shadow=0;glass=0;labelBackgroundColor=none;fontFamily=Comic Sans MS;strokeColor=#82b366;" vertex="1" parent="1">
          <mxGeometry x="-260.44000000000005" y="1149" width="292.21" height="66" as="geometry" />
        </mxCell>
        <mxCell id="bS2-JoX9ewdRHK1aLQZ--23" value="调用子节点accept方法&lt;font color=&quot;#ff3333&quot;&gt;QueryTermDefaultContext -&amp;gt; QueryPrimaryDefaultContext&lt;/font&gt;&lt;br&gt;&lt;div class=&quot;okr-block-clipboard&quot;&gt;&lt;/div&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;shadow=0;glass=0;labelBackgroundColor=none;sketch=1;fontSize=11;fontColor=#6666FF;fontFamily=Comic Sans MS;" vertex="1" parent="1">
          <mxGeometry x="-753.89" y="1156" width="202.49" height="52" as="geometry" />
        </mxCell>
        <mxCell id="bS2-JoX9ewdRHK1aLQZ--29" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontColor=#876E54;" edge="1" parent="1" source="bS2-JoX9ewdRHK1aLQZ--24" target="bS2-JoX9ewdRHK1aLQZ--28">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="-113.84000000000003" y="1325" />
              <mxPoint x="-443.84000000000003" y="1325" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="bS2-JoX9ewdRHK1aLQZ--24" value="&lt;div&gt;&lt;span style=&quot;font-size: 13.0667px&quot;&gt;SqlBaseBaseVisitor.visitQueryPrimaryDefault(ctx){&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;font-size: 13.0667px&quot;&gt;&amp;nbsp; &amp;nbsp; this.visitChildren(ctx)&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;font-size: 13.0667px&quot;&gt;}&lt;/span&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;sketch=1;fillColor=#d5e8d4;shadow=0;glass=0;labelBackgroundColor=none;fontFamily=Comic Sans MS;strokeColor=#82b366;" vertex="1" parent="1">
          <mxGeometry x="-275.84000000000003" y="1242" width="323" height="66" as="geometry" />
        </mxCell>
        <mxCell id="bS2-JoX9ewdRHK1aLQZ--27" value="同上&lt;br&gt;&lt;div class=&quot;okr-block-clipboard&quot;&gt;&lt;/div&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;shadow=0;glass=0;labelBackgroundColor=none;sketch=1;fontSize=11;fontColor=#6666FF;fontFamily=Comic Sans MS;" vertex="1" parent="1">
          <mxGeometry x="44.15999999999997" y="1164" width="69" height="36" as="geometry" />
        </mxCell>
        <mxCell id="bS2-JoX9ewdRHK1aLQZ--31" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontColor=#876E54;" edge="1" parent="1" source="bS2-JoX9ewdRHK1aLQZ--28" target="bS2-JoX9ewdRHK1aLQZ--30">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="bS2-JoX9ewdRHK1aLQZ--28" value="&lt;div&gt;&lt;span style=&quot;font-size: 13.0667px&quot;&gt;AstBuilder.visitChildren(){&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;font-size: 13.0667px&quot;&gt;&amp;nbsp; node.getChild(0).accept(this)&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;font-size: 13.0667px&quot;&gt;}&lt;/span&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;sketch=1;fillColor=#dae8fc;shadow=0;glass=0;labelBackgroundColor=none;fontFamily=Comic Sans MS;strokeColor=#6c8ebf;" vertex="1" parent="1">
          <mxGeometry x="-539.54" y="1349" width="191" height="62" as="geometry" />
        </mxCell>
        <mxCell id="bS2-JoX9ewdRHK1aLQZ--33" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontColor=#876E54;" edge="1" parent="1" source="bS2-JoX9ewdRHK1aLQZ--30" target="bS2-JoX9ewdRHK1aLQZ--32">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="-110.84000000000003" y="1441" />
              <mxPoint x="-439.84000000000003" y="1441" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="bS2-JoX9ewdRHK1aLQZ--30" value="&lt;div&gt;&lt;span style=&quot;font-size: 13.0667px&quot;&gt;SqlBaseParser.RegularQuerySpecificationContext{&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;font-size: 13.0667px&quot;&gt;accept(visitor){&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;font-size: 13.0667px&quot;&gt;visitRegularQuerySpecification(this)&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;font-size: 13.0667px&quot;&gt;}}&lt;/span&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;sketch=1;fillColor=#d5e8d4;shadow=0;glass=0;labelBackgroundColor=none;fontFamily=Comic Sans MS;strokeColor=#82b366;" vertex="1" parent="1">
          <mxGeometry x="-275.24000000000007" y="1345.5" width="328.35" height="69" as="geometry" />
        </mxCell>
        <mxCell id="bS2-JoX9ewdRHK1aLQZ--32" value="&lt;div&gt;&lt;span style=&quot;font-size: 13.0667px&quot;&gt;AstBuilder.visitRegularQuerySpecification(ctx){&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;font-size: 13.0667px&quot;&gt;&amp;nbsp; visitFromClause(ctx.fromClause)&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;font-size: 13.0667px&quot;&gt;&amp;nbsp; withSelectQuerySpecification(...)&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;font-size: 13.0667px&quot;&gt;}&lt;/span&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;sketch=0;fillColor=#f8cecc;shadow=0;glass=0;labelBackgroundColor=none;fontFamily=Comic Sans MS;strokeColor=#b85450;" vertex="1" parent="1">
          <mxGeometry x="-604.19" y="1474" width="312.35" height="69" as="geometry" />
        </mxCell>
        <mxCell id="bS2-JoX9ewdRHK1aLQZ--35" value="&lt;h1 style=&quot;font-size: 11px&quot;&gt;spark重写的重要节点&lt;/h1&gt;&lt;div style=&quot;font-size: 11px&quot;&gt;1. 访问 from 子句&lt;/div&gt;&lt;div style=&quot;font-size: 11px&quot;&gt;2. 访问其他子句：&lt;/div&gt;&lt;div style=&quot;font-size: 11px&quot;&gt;select&lt;/div&gt;&lt;div style=&quot;font-size: 11px&quot;&gt;lateralview&lt;/div&gt;&lt;div style=&quot;font-size: 11px&quot;&gt;where&lt;/div&gt;&lt;div style=&quot;font-size: 11px&quot;&gt;aggregation&lt;/div&gt;&lt;div style=&quot;font-size: 11px&quot;&gt;having等&lt;/div&gt;" style="text;html=1;strokeColor=none;fillColor=none;spacing=5;spacingTop=-20;whiteSpace=wrap;overflow=hidden;rounded=0;sketch=0;fontColor=#FF3333;fontSize=11;" vertex="1" parent="1">
          <mxGeometry x="-722.84" y="1444" width="133" height="129" as="geometry" />
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
